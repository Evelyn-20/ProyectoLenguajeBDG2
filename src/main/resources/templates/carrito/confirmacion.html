<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
    <head th:replace="~{layout/plantilla :: head}">
        <title>Nous - Confirmación de Compra</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    </head>
    <body class="d-flex flex-column min-vh-100 bg-light">
        <header th:replace="~{layout/plantilla :: header}"></header>
        
        <section class="py-5 flex-grow-1">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        
                        <!-- Mensaje de éxito -->
                        <div class="text-center mb-5">
                            <div class="mb-4">
                                <i class="fas fa-check-circle text-success" style="font-size: 5rem;"></i>
                            </div>
                            <h1 class="display-4 fw-bold text-success mb-3">¡Compra Exitosa!</h1>
                            <p class="lead text-muted">Tu pedido ha sido procesado correctamente</p>
                        </div>

                        <!-- Información de la venta -->
                        <div class="card shadow-sm rounded-4 border-0 mb-4">
                            <div class="card-body p-4">
                                <h5 class="fw-bold mb-4">
                                    <i class="fas fa-receipt me-2 text-primary"></i>
                                    Detalles de tu Pedido
                                </h5>
                                
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <strong>Número de Venta:</strong>
                                        <span th:text="${venta?.ventaId ?: 'No disponible'}" class="text-primary">#12345</span>
                                    </div>
                                    <div class="col-md-6">
                                        <strong>Código de Venta:</strong>
                                        <span th:text="${venta?.codigoVenta ?: 'No disponible'}" class="text-muted">V123456789</span>
                                    </div>
                                </div>
                                
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <strong>Fecha:</strong>
                                        <span th:text="${venta?.fechaVenta != null ? #temporals.format(venta.fechaVenta, 'dd/MM/yyyy HH:mm') : #temporals.format(#temporals.createNow(), 'dd/MM/yyyy HH:mm')}" class="text-muted">18/08/2025 10:19</span>
                                    </div>
                                    <div class="col-md-6">
                                        <strong>Estado:</strong>
                                        <span th:text="${venta?.estado ?: 'Pendiente'}" class="badge bg-warning text-dark">Pendiente</span>
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-6">
                                        <strong>Método de Pago:</strong>
                                        <span th:text="${venta?.medioPago ?: 'No especificado'}" class="text-muted">Tarjeta</span>
                                    </div>
                                    <div class="col-md-6">
                                        <strong>Total Pagado:</strong>
                                        <span th:text="'₡' + ${venta?.total != null ? #numbers.formatDecimal(venta.total, 1, 2, 'COMMA') : '0,00'}" class="fw-bold text-success fs-5">₡0,00</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Productos comprados -->
                        <div th:if="${detalles != null and !detalles.empty}" class="card shadow-sm rounded-4 border-0 mb-4">
                            <div class="card-body p-4">
                                <h5 class="fw-bold mb-4">
                                    <i class="fas fa-shopping-bag me-2 text-success"></i>
                                    Productos Comprados
                                </h5>
                                
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead class="table-light">
                                            <tr>
                                                <th>Producto</th>
                                                <th class="text-center">Cantidad</th>
                                                <th class="text-end">Precio Unit.</th>
                                                <th class="text-end">Subtotal</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr th:each="detalle : ${detalles}">
                                                <td>
                                                    <span th:text="${detalle.nombreProducto ?: 'Producto ID: ' + detalle.inventarioId}">Producto</span>
                                                </td>
                                                <td class="text-center">
                                                    <span th:text="${detalle.cantidad}">1</span>
                                                </td>
                                                <td class="text-end">
                                                    <span th:text="'₡' + ${#numbers.formatDecimal(detalle.precioUnitario, 1, 2, 'COMMA')}">₡0,00</span>
                                                </td>
                                                <td class="text-end fw-semibold">
                                                    <span th:text="'₡' + ${#numbers.formatDecimal(detalle.subtotalDetalle, 1, 2, 'COMMA')}">₡0,00</span>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- Botones de acción -->
                        <div class="row gap-3 justify-content-center">
                            <div class="col-auto">
                                <a href="/" class="btn btn-dark btn-lg px-4 py-3 rounded-3">
                                    <i class="fas fa-home me-2"></i>
                                    Volver al Inicio
                                </a>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </section>
        
        <footer th:replace="~{layout/plantilla :: footer}"></footer>
        
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    </body>
</html>